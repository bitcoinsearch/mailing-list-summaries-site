<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Duplicate transactions vulnerability <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
        <ul>
            
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001265_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-28 16:48:39</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001269_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Luke-Jr 2012-02-28 18:23:01</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001273_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Ben Reeves 2012-02-28 20:35:05</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001277_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-29 16:47:48</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001281_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Matt Corallo 2012-02-29 22:38:13</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001283_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Ben Reeves 2012-02-29 23:00:42</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001284_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-29 23:45:59</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001288_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-03-01 14:30:30</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001299_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-03-03 16:41:03</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001285_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Ben Reeves 2012-03-01 10:15:01</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001287_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Gregory Maxwell 2012-03-01 14:27:53</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001289_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Ben Reeves 2012-03-01 17:20:41</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001290_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-03-02 01:56:34</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001275_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Zooko Wilcox-O&#39;Hearn 2012-02-29 01:41:31</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001279_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Stefan Thomas 2012-02-29 21:00:44</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001280_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Ben Reeves 2012-02-29 22:05:55</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001283_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Ben Reeves 2012-02-29 23:00:42</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001299_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-03-03 16:41:03</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001267_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-28 17:18:12</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001272_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-28 20:24:15</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001277_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-29 16:47:48</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001281_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Matt Corallo 2012-02-29 22:38:13</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001283_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Ben Reeves 2012-02-29 23:00:42</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001299_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-03-03 16:41:03</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001288_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-03-01 14:30:30</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001266_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Brautigam Róbert 2012-02-28 17:12:12</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001267_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-28 17:18:12</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001268_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Gavin Andresen 2012-02-28 18:10:41</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001275_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Zooko Wilcox-O&#39;Hearn 2012-02-29 01:41:31</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001278_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Amir Taaki 2012-02-29 17:02:29</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001279_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Stefan Thomas 2012-02-29 21:00:44</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001280_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Ben Reeves 2012-02-29 22:05:55</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001286_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Ben Reeves 2012-03-01 13:09:02</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001289_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Ben Reeves 2012-03-01 17:20:41</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001290_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-03-02 01:56:34</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001266_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Brautigam Róbert 2012-02-28 17:12:12</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001267_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-28 17:18:12</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001269_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Luke-Jr 2012-02-28 18:23:01</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001272_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-28 20:24:15</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001277_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-29 16:47:48</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001278_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Amir Taaki 2012-02-29 17:02:29</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001282_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Gavin Andresen 2012-02-29 22:46:55</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001284_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-29 23:45:59</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001288_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-03-01 14:30:30</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001265_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-28 16:48:39</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001273_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Ben Reeves 2012-02-28 20:35:05</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001275_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Zooko Wilcox-O&#39;Hearn 2012-02-29 01:41:31</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001282_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Gavin Andresen 2012-02-29 22:46:55</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001286_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Ben Reeves 2012-03-01 13:09:02</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001289_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Ben Reeves 2012-03-01 17:20:41</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001290_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-03-02 01:56:34</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001272_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-28 20:24:15</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001282_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Gavin Andresen 2012-02-29 22:46:55</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001285_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Ben Reeves 2012-03-01 10:15:01</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001287_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Gregory Maxwell 2012-03-01 14:27:53</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001265_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-28 16:48:39</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001268_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Gavin Andresen 2012-02-28 18:10:41</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001273_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Ben Reeves 2012-02-28 20:35:05</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001281_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Matt Corallo 2012-02-29 22:38:13</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001286_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Ben Reeves 2012-03-01 13:09:02</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001266_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Brautigam Róbert 2012-02-28 17:12:12</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001268_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Gavin Andresen 2012-02-28 18:10:41</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001269_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Luke-Jr 2012-02-28 18:23:01</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001278_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Amir Taaki 2012-02-29 17:02:29</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001279_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Stefan Thomas 2012-02-29 21:00:44</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001280_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Ben Reeves 2012-02-29 22:05:55</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001284_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-29 23:45:59</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001285_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Ben Reeves 2012-03-01 10:15:01</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001287_Duplicate-transactions-vulnerability.html">Duplicate transactions vulnerability</a>
                        <b>Gregory Maxwell 2012-03-01 14:27:53</b>
                    </li>
                
            
        </ul>
        
            <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2012-February/001265.html">Click here to read the original discussion on the bitcoin-dev mailing list</a>
        
        <p><i>Published on: 2012-02-28T16:48:39+00:00</i></p>
        <hr>
        <h3>Summary:</h3>
        <p>In 2012, a security vulnerability was discovered in the Bitcoin reference client when dealing with duplicate transactions. The proposed solution to fix this issue was adding an extra protocol rule which disallows blocks containing a transaction hash that is equal to that of a former transaction which has not yet been completely spent. This proposal was outlined in BIP30, and there is a patch for the reference client that has been tested and verified to make the attack impossible. The change is backward compatible and, if implemented by a supermajority of mining power, old clients can continue to function without risk.However, some members of the community raised concerns about potential weaknesses in the proposed patch. For instance, spent coinbases could still be disconnected, causing errors in LoadBlockIndex() upon restart and creating problems during the initial blockchain download for new clients. To address these concerns, developers suggested disallowing duplicate coinbases entirely and bundling both BIP16 and BIP30 in 0.6. In addition, they recommended preparing a blockchain repair script that checks the db for missing coinbase transactions and downloads them from another peer or block explorer if necessary.There were also discussions around the possibility of a malicious miner producing a duplicate coinbase, which could create a forked chain and spend the old coinbase. However, there are measures in place to prevent such malicious activities from succeeding in the Bitcoin network. Overall, the Bitcoin community worked together to find a solution to the security vulnerability and ensure the safety of the network.Pieter Wuille asked for support for adding the extra protocol rule to prevent a possible attack on the network, hoping pools and miners can agree to update their nodes without lengthy coinbase-flagging procedures that would only delay a solution. There were concerns about the vulnerability of patched clients to blockchain corruption despite the implementation in the reference patch fixing the forking issue, and suggestions were made to prevent blockchain corruption by disallowing duplicate coinbases entirely and bundling both BIP16 and BIP30 in 0.6 as mandatory upgrades for everyone. It was noted that although implementing the proposed solution would be backward compatible, assuming 50% of hashing power adopts BIP30, but the actual client install base is relatively low, the patch will likely result in a "hard" blockchain split if someone takes advantage. A malicious miner can produce a duplicate coinbase which the majority of clients will accept but the majority of hashing power won't. Spending the coinbase output after disconnection will cause the blockchain to fork. All non-BIP30 clients on the short blockchain will be vulnerable to transaction reversal of 6 confirmations or more. It is a relatively inexpensive attack to perform, costing the attacker only one valid block (approximately $240) and could be quite disruptive.On February 28th, 2012, Pieter Wuille proposed a solution to prevent an attack on the Bitcoin protocol involving duplicate transactions. The proposed solution involved adding an extra protocol rule to disallow blocks containing a transaction whose hash is equal to that of a former transaction which has not yet been completely spent. This solution was outlined in BIP30 and had a patch available for the reference client. Wuille requested support from the community to add this rule to the protocol rules and hoped pools and miners would agree to update their nodes without any delay-causing coinbase-flagging procedure if consensus was reached on this solution.In response to Ben Reeves' concerns about the DisconnectBlock() fix, it was suggested that exchanges and major merchants need to be informed about upgrading their systems, and both BIP16 and BIP30 should be bundled in 0.6 and issued as a mandatory upgrade for everyone. Additionally, it was proposed that a blockchain repair script be prepared, which could check the database for missing coinbase transactions and download them from another peer or block explorer if necessary.The Bitcoin community was actively working towards finding a solution to the security vulnerability to ensure the safety of the network.</p>
        <hr>
        <p><i>Updated on: 2023-06-06T03:15:42.351567+00:00</i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>